# Feature Specification: 學生運動資料管理系統

**Feature Branch**: `003-student-sports-data`
**Created**: 2025-12-01
**Status**: Draft
**Input**: User description: "完善用戶可以建立各個學校的學生運動資料，目前此計畫的目的就是建立一個能夠提供建立跟紀錄運動學生的數值，以用於培養優秀運動人才的紀錄工具，所以需要完善核心功能 [用戶登入][資料建置][資料紀錄][資料分析][資料搜尋]"

## Overview

本功能旨在建立一個完整的學生運動資料管理系統，讓教練、體育老師和學校管理人員能夠：
- 建立和管理學校與學生基本資料
- 記錄學生的運動表現數據（如體能測驗、比賽成績）
- 搜尋和查詢學生資料
- 分析學生運動表現趨勢，以識別和培養優秀運動人才

**前置條件**：用戶登入功能已在 001-user-auth 中實作完成。

## Clarifications

### Session 2025-12-01

- Q: 系統應包含哪些預設運動項目？ → A: 涵蓋三大類：體適能標準項目、田徑基礎項目、球類基礎測驗

## User Scenarios & Testing

### User Story 1 - 學校與學生資料建置 (Priority: P1) 🎯 MVP

教練或學校管理人員需要能夠建立學校資料，並在該學校下新增學生基本資料，包括姓名、年級、性別、出生日期等，作為後續運動數據記錄的基礎。

**Why this priority**: 這是系統的核心基礎功能。沒有學校和學生資料，就無法進行任何運動數據的記錄和分析。這是所有其他功能的前置條件。

**Independent Test**: 登入系統後，可以建立一所學校並新增該校的學生資料，完成後能在列表中看到新建的學校和學生。

**Acceptance Scenarios**:

1. **Given** 用戶已登入系統，**When** 用戶填寫學校資料（名稱、縣市、地址）並提交，**Then** 系統建立學校記錄並顯示成功訊息
2. **Given** 已存在學校記錄，**When** 用戶選擇該學校並新增學生資料（姓名、學號、年級、性別、出生日期），**Then** 系統建立學生記錄並關聯至該學校
3. **Given** 已存在學生記錄，**When** 用戶修改學生基本資料，**Then** 系統更新記錄並顯示最新資料
4. **Given** 已存在學生記錄，**When** 用戶刪除學生，**Then** 系統標記該學生為已刪除（軟刪除）並從列表中隱藏

---

### User Story 2 - 運動數據記錄 (Priority: P2)

教練需要能夠為學生記錄各項運動測驗數據，包括體能測驗（如跑步時間、跳遠距離）和比賽成績，每筆記錄需包含測驗日期和項目類型。

**Why this priority**: 運動數據記錄是系統的核心價值所在。有了學生基礎資料後，記錄運動表現是識別運動人才的關鍵步驟。

**Independent Test**: 選擇一位學生，為其新增一筆運動測驗記錄（如 100 公尺跑步 12.5 秒），完成後能在該學生的記錄列表中看到此筆資料。

**Acceptance Scenarios**:

1. **Given** 用戶已選擇一位學生，**When** 用戶填寫運動記錄（項目類型、數值、單位、測驗日期）並提交，**Then** 系統建立運動記錄並關聯至該學生
2. **Given** 學生已有運動記錄，**When** 用戶查看該學生的記錄列表，**Then** 系統顯示所有記錄，按日期排序
3. **Given** 用戶正在新增記錄，**When** 用戶選擇運動項目類型，**Then** 系統自動帶入該項目的預設單位（如跑步用秒、跳遠用公分）
4. **Given** 已存在運動記錄，**When** 用戶修改記錄數值，**Then** 系統更新記錄並保留修改歷史

---

### User Story 3 - 學生資料搜尋 (Priority: P3)

用戶需要能夠快速搜尋學生，可依學校、姓名、年級等條件進行篩選，以便快速找到目標學生並查看其資料。

**Why this priority**: 當系統累積大量學生資料後，有效的搜尋功能是提升使用效率的關鍵。這是日常使用中頻繁需要的功能。

**Independent Test**: 在搜尋框輸入學生姓名的部分文字，系統顯示符合條件的學生列表，點擊可查看該學生詳細資料。

**Acceptance Scenarios**:

1. **Given** 系統中有多位學生，**When** 用戶輸入姓名關鍵字搜尋，**Then** 系統顯示姓名包含該關鍵字的學生列表
2. **Given** 系統中有多所學校，**When** 用戶選擇特定學校進行篩選，**Then** 系統僅顯示該學校的學生
3. **Given** 用戶使用多個條件（學校+年級）搜尋，**When** 提交搜尋，**Then** 系統顯示同時符合所有條件的學生
4. **Given** 搜尋結果為空，**When** 顯示結果，**Then** 系統顯示「無符合條件的學生」訊息並建議調整條件

---

### User Story 4 - 運動表現分析 (Priority: P4)

教練需要能夠查看學生的運動表現趨勢分析，包括各項目的歷史數據圖表、進步或退步趨勢，以便評估訓練成效並識別潛力運動員。

**Why this priority**: 數據分析是將原始數據轉化為有價值洞見的功能，幫助教練做出培訓決策。但需要先有足夠的數據積累才能發揮價值。

**Independent Test**: 查看一位有多筆運動記錄的學生，系統顯示該學生各項目的歷史趨勢圖表，並標示進步或退步。

**Acceptance Scenarios**:

1. **Given** 學生有同一項目的多筆歷史記錄，**When** 用戶查看該學生的分析頁面，**Then** 系統顯示該項目的趨勢折線圖
2. **Given** 學生的最近記錄優於歷史平均，**When** 顯示分析結果，**Then** 系統標示「進步」並顯示進步幅度百分比
3. **Given** 用戶查看學校層級的分析，**When** 選擇特定運動項目，**Then** 系統顯示該校學生在此項目的排名分佈
4. **Given** 學生記錄少於 3 筆，**When** 用戶查看分析，**Then** 系統顯示「數據不足，無法進行趨勢分析」訊息

---

### Edge Cases

- 當學校被刪除時，該校所有學生記錄如何處理？（採用軟刪除，保留歷史數據）
- 當輸入的運動數值超出合理範圍時如何處理？（顯示警告但允許儲存，可能是特殊情況）
- 當同一天記錄同一項目多次時如何處理？（允許多筆記錄，用時間戳區分）
- 當用戶嘗試建立重複的學校時如何處理？（根據名稱+縣市判斷重複，提示已存在）

## Requirements

### Functional Requirements

**學校管理**:
- **FR-001**: 系統必須允許用戶建立學校資料，包含名稱、縣市、地址、聯絡電話
- **FR-002**: 系統必須允許用戶編輯學校基本資料
- **FR-003**: 系統必須支援學校的軟刪除，保留歷史資料完整性

**學生管理**:
- **FR-004**: 系統必須允許用戶在學校下建立學生資料，包含姓名、學號、年級、班級、性別、出生日期
- **FR-005**: 系統必須驗證學號在同一學校內的唯一性
- **FR-006**: 系統必須允許用戶編輯學生基本資料
- **FR-007**: 系統必須支援學生的軟刪除，保留歷史運動記錄

**運動記錄**:
- **FR-008**: 系統必須允許用戶為學生建立運動記錄，包含項目類型、數值、單位、測驗日期、備註
- **FR-009**: 系統必須提供預設的運動項目類型列表，涵蓋三大類：
  - 體適能標準項目：800公尺、1600公尺、坐姿體前彎、1分鐘仰臥起坐、立定跳遠、1分鐘屈膝仰臥起坐
  - 田徑基礎項目：100公尺、200公尺、400公尺、跳遠、跳高、鉛球、壘球擲遠
  - 球類基礎測驗：籃球運球、足球運球、排球墊球、桌球正手擊球
- **FR-010**: 系統必須根據運動項目自動帶入預設單位
- **FR-011**: 系統必須允許用戶編輯運動記錄
- **FR-012**: 系統必須保留運動記錄的修改歷史

**搜尋功能**:
- **FR-013**: 系統必須支援依學生姓名進行模糊搜尋
- **FR-014**: 系統必須支援依學校進行篩選
- **FR-015**: 系統必須支援依年級進行篩選
- **FR-016**: 系統必須支援多條件組合搜尋

**數據分析**:
- **FR-017**: 系統必須能顯示學生單一項目的歷史趨勢圖表
- **FR-018**: 系統必須能計算並顯示學生的進步/退步趨勢
- **FR-019**: 系統必須能顯示學校內學生在特定項目的排名

### Key Entities

- **School（學校）**: 代表一所學校，包含名稱、縣市、地址等基本資訊，是學生資料的組織單位
- **Student（學生）**: 代表一位學生，隸屬於某學校，包含個人基本資料，是運動記錄的主體
- **SportType（運動項目）**: 代表一種運動測驗項目，包含名稱、類別（體適能/田徑/球類）、預設單位、數值類型（時間/距離/次數/分數）
- **SportRecord（運動記錄）**: 代表一筆運動測驗記錄，關聯學生和運動項目，包含數值、日期等

## Success Criteria

### Measurable Outcomes

- **SC-001**: 用戶可在 2 分鐘內完成一所學校的建立
- **SC-002**: 用戶可在 1 分鐘內完成一位學生的基本資料建立
- **SC-003**: 用戶可在 30 秒內為學生新增一筆運動記錄
- **SC-004**: 搜尋結果在 2 秒內顯示
- **SC-005**: 系統可支援單一學校 1000 位學生的資料管理
- **SC-006**: 系統可支援單一學生 500 筆運動記錄的儲存和查詢
- **SC-007**: 趨勢分析圖表在 3 秒內載入完成
- **SC-008**: 90% 的用戶首次使用即可成功完成學生資料建立和運動記錄新增

## Assumptions

- 用戶登入功能已在 001-user-auth 中實作完成，本功能將重用該認證機制
- 所有操作都需要用戶登入後才能執行
- 運動項目類型清單為系統預設，初期不開放用戶自訂
- 數據以縣市為單位歸類，與 002-map-visualization 的縣市資料一致
- 軟刪除的資料不會在一般查詢中顯示，但管理員可以恢復

## Out of Scope

- 用戶權限分級（如：教練 vs 管理員）- 未來功能
- 批次匯入學生資料（CSV/Excel）- 未來功能
- 運動記錄的照片或影片附件 - 未來功能
- 跨校學生資料比較 - 未來功能
- 匯出報表功能 - 未來功能
